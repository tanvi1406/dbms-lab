CREATE TABLE SALESMAN(SALESMAN_ID INTEGER,NAME VARCHAR(15),CITY VARCHAR(20),COMMISION INTEGER,PRIMARY KEY(SALESMAN_ID));
CREATE TABLE CUSTOMER(CUSTOMER_ID INTEGER,CUST_NAME VARCHAR(20),CITY VARCHAR(20),GRADE VARCHAR(5),SALESMAN_ID INTEGER,PRIMARY KEY(CUSTOMER_ID),FOREIGN KEY(SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID) ON DELETE CASCADE);
CREATE TABLE ORDERS(ORD_NO INTEGER,PURCHASE_AMT INTEGER,ORD_DATE DATE,CUSTOMER_ID INTEGER, SALESMAN_ID INTEGER,PRIMARY KEY(ORD_NO),FOREIGN KEY(CUSTOMER_ID)REFERENCES CUSTOMER(CUSTOMER_ID) ON DELETE CASCADE,FOREIGN KEY(SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID) ON DELETE CASCADE);

INSERT INTO SALESMAN VALUES(10,'AKASH','MANGALORE',2);
INSERT INTO SALESMAN VALUES(20,'RAM','BANGALORE',10);
INSERT INTO SALESMAN VALUES(30,'RAJ','MANGALORE',5);
INSERT INTO SALESMAN VALUES(40,'KIRAN','MYSORE',15);
INSERT INTO SALESMAN VALUES(50,'SHEYA','BANGALORE',3);

INSERT INTO CUSTOMER VALUES(1000,'AVINASH','MANGALORE',100,10);
INSERT INTO CUSTOMER VALUES(2000,'KUMAR','BANGALORE',200,20);
INSERT INTO CUSTOMER VALUES(3000,'PREETHI','MYSORE',300,40);
INSERT INTO CUSTOMER VALUES(4000,'SMITHA','MANGALORE',400,30);
INSERT INTO CUSTOMER VALUES(5000,'VARSHINI','BANGALORE',400,50);

INSERT INTO ORDERS VALUES(551,5000,'2020-01-04',1000,10);
INSERT INTO ORDERS VALUES(552,2500,'2020-02-05',2000,20);
INSERT INTO ORDERS VALUES(553,500,'2020-03-03',3000,40);
INSERT INTO ORDERS VALUES(554,1500,'2020-04-02',4000,30);
INSERT INTO ORDERS VALUES(555,2000,'2020-01-03',2000,10);
INSERT INTO ORDERS VALUES(556,3500,'2020-01-03',2000,30);


QUERY2:
SELECT NAME , SALESMAN_ID
FROM SALESMAN S
WHERE 1<
(SELECT COUNT(*)
 FROM ORDERS O
 WHERE S.SALESMAN_ID=O.SALESMAN_ID);

RESULTS:
 NAME  SALESMAN_ID 
 AKASH  10          


QUERY1:
UPDATE CUSTOMER SET GRADE=400 WHERE CUSTOMER_ID=1000;

SELECT GRADE,COUNT(*)
FROM CUSTOMER 
WHERE GRADE>
(SELECT AVG(GRADE) 
 FROM CUSTOMER
 WHERE CITY='BANGALORE')
GROUP BY GRADE;

RESULTS:
Query #1 Execution time: 1ms
There are no results to be displayed.

Query #2 Execution time: 0ms
GRADE	COUNT(*)
400	   3

QUERY3:
SELECT * 
FROM SALESMAN
WHERE SALESMAN_ID IN(
SELECT SALESMAN_ID
FROM SALESMAN S
WHERE EXISTS
  (SELECT  SALESMAN_ID
   FROM CUSTOMER C 
   WHERE S.CITY=C.CITY AND S.SALESMAN_ID=C.SALESMAN_ID)
                  UNION
SELECT SALESMAN_ID
FROM SALESMAN S
WHERE NOT EXISTS
  (SELECT  SALESMAN_ID
   FROM CUSTOMER C 
   WHERE S.CITY=C.CITY AND S.SALESMAN_ID=C.SALESMAN_ID))

RESULTS:
SALESMAN_ID	NAME	CITY	    COMMISION
10	        AKASH	MANGALORE	2
20	         RAM	BANGALORE	10
30	         RAJ	MANGALORE	5
40	       KIRAN	MYSORE	        15
50	       SHEYA	BANGALORE	3

QUERY 4:
CREATE VIEW BEST_SALESMAN AS
SELECT SALESMAN_ID ,ORD_DATE,PURCHASE_AMT
FROM ORDERS
WHERE PURCHASE_AMT IN(
  	SELECT MAX(PURCHASE_AMT)
  	FROM ORDERS 
  	GROUP BY ORD_DATE);
SELECT * FROM BEST_SALESMAN;

RESULTS:
SALESMAN_ID	ORD_DATE	PURCHASE_AMT
10	       2020-01-04	   5000
20	       2020-02-05	   2500
40	       2020-03-03	    500
30	       2020-04-02	   1500
30	       2020-01-03	   3500


QUERY5:
DELETE FROM SALESMAN WHERE SALESMAN_ID=10;
SELECT * FROM SALESMAN;
SELECT * FROM CUSTOMER;
SELECT * FROM ORDERS;

RESULTS:
Query #1 Execution time: 1ms
There are no results to be displayed.
Query #2 Execution time: 0ms
SALESMAN_ID	NAME	CITY	     COMMISION
20	        RAM	BANGALORE	10
30	        RAJ	MANGALORE	5
40	       KIRAN	MYSORE	        15
50	       SHEYA	BANGALORE	3
Query #3 Execution time: 0ms
CUSTOMER_ID	CUST_NAME	CITY	  GRADE	  SALESMAN_ID
1000	         AVINASH      MANGALORE	   100	   null
2000	          KUMAR	      BANGALORE	   200	    20
3000	         PREETHI       MYSORE	   300	    40
4000	         SMITHA	      MANGALORE	   400	    30
5000	        VARSHINI      BANGALORE	   400	    50
Query #4 Execution time: 2ms
ORD_NO	PURCHASE_AMT	ORD_DATE	CUSTOMER_ID	SALESMAN_ID
552	  2500	       2020-02-05	2000	           20
553	  500	       2020-03-03	3000	           40
554	  1500	       2020-04-02	4000	           30
556	  3500	       2020-01-03	2000	           30
